# Решатель CAPTCHA с использованием CRNN и CTC Loss

Этот репозиторий содержит реализацию **Convolutional Recurrent Neural Network (CRNN)** с **CTC Loss** на PyTorch для распознавания текста на CAPTCHA. Модель способна распознавать текст переменной длины (до 4 символов).

---

## Основные особенности
- **Архитектура CRNN**: Сочетает CNN для извлечения пространственных признаков и двунаправленный GRU для обработки последовательностей.
- **CTC Loss**: Позволяет работать с CAPTCHA переменной длины без необходимости выравнивания данных.
- **Аугментация данных**: Включает повороты, изменение яркости/контраста, аффинные преобразования и размытие.
- **Ранняя остановка**: Автоматически прекращает обучение при ухудшении качества на валидации.

---

## Требования
- Python 3.8+
- PyTorch
- torchvision
- Pillow (PIL)
- tqdm
- numpy

Установка зависимостей:
```bash
pip install torch torchvision pillow tqdm numpy
```

---

## Подготовка данных
- Данные для тестирования брались с kaggle.com/datasets/fanbyprinciple/captcha-images
1. Организуйте датасет в две папки:
   ```
   data/
   ├── train/  # Обучающие изображения (например, "abc123.png")
   └── val/    # Валидационные изображения (например, "xyz456.jpg")
   ```
2. Имена файлов должны **точно соответствовать тексту CAPTCHA** (регистр игнорируется, расширение убирается).

---

## Обучение
Запустите обучение:
```bash
python main.py
```

### Ключевые гиперпараметры (можно изменить в коде):
- `BATCH_SIZE = 128`
- `EPOCHS = 100`
- `LEARNING_RATE = 0.0005`
- `MAX_CAPTCHA_LENGTH = 4`
- Размер изображений: `72x24` пикселей (можно настроить в `transform`).

Лучшая модель сохраняется как `captcha_model_best.pth`.

---
## Запуск модели про проверки

```bash
python valid.py
```

---
## Результаты

![image](https://github.com/user-attachments/assets/9a143263-2c7b-40f4-9872-090655a87723)
- В логах обучения отображаются **точность** и **loss** для каждой эпохи.
- Лучшая модель выбирается по минимальному loss на валидации.
---
huggingface.co/Mike98ssq/captcha

## Примечания
- Изображения конвертируются в grayscale и масштабируются до **72x24**.
- Поддерживаемые символы: строчные и прописные латинские буквы + цифры (всего 62 класса).
